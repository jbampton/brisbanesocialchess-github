---
name: ğŸƒğŸ¼ pre-commit

on: [push, pull_request]

permissions:
  contents: read

jobs:
  pre-commit:
    name: ğŸƒğŸ¼â€â™€ï¸â€â¡ï¸ Run pre-commit
    runs-on: ubuntu-latest

    steps:
      - name: âœ… Checkout code
        uses: actions/checkout@de0fac2e4500dabe0009e67214ff5f5447ce83dd
        with:
          persist-credentials: false

      - name: ğŸ Set up Python
        uses: actions/setup-python@a309ff8b426b58ec0e2a45f0f869d46889d02405
        with:
          python-version: '3.14'

      - name: ğŸ“ Set Python Version Hash
        run: echo "PY=$(python -VV | sha256sum | cut -d' ' -f1)" >> "$GITHUB_ENV"

      - name: ğŸ¥¡ Cache pre-commit
        uses: actions/cache@cdf6c1fa76f9f475f3d7449005a359c84ca0f306
        with:
          path: ~/.cache/pre-commit
          key: pre-commit|${{ env.PY }}|${{ hashFiles('.pre-commit-config.yaml') }}

      - name: ğŸ—ï¸ Install pre-commit
        run: |
          python -m pip install --upgrade pip
          pip install pre-commit

      - name: ğŸƒâ€â™€ï¸ Run pre-commit
        run: pre-commit run --color=always --all-files --show-diff-on-failure
      - name: ğŸƒğŸ¼â€â™€ï¸â€â¡ï¸ Run manual pre-commit hooks
        run: pre-commit run --color=always --all-files --hook-stage manual --show-diff-on-failure
